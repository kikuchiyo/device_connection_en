# 创建模型

模型是对产品功能的抽象，模型定义了产品是什么、能做什么、可以对外提供哪些服务。该文章描述了如何创建模型。

## 开始前准备
已设计好该模型所需要的功能。有何如何进行模型的功能设计，参见[物模型概述](../model_overview)

## 任务描述

根据定义好的物模型，在EnOS中配置各项功能。
- 属性
- 测点
- 服务
- 事件

## 步骤一：创建模型

1. 在EnOS控制台中选择**接入管理>模型管理**。
2. 点击页面右上方**创建模型**，在**创建模型**页面配置下列信息：
  - **模型标识符**：模型的唯一识别码。
  - **模型名称**：模型的名称，在同一组织下不可重复。
  - **分类**：产品的静态扩展信息。如厂商、设备型号等。
  - **模型关系**：
    - 无：暂不配置具体属性。在模板创建完毕后手动定义要素。
    - 拷贝：复制源模型上的所有信息。通过拷贝创建的模型与其源模型无关联。
    - 继承：复制源模型上的所有信息。与源模型关联。    
      - 子模型继承父模型的所有元素，子模板不可修改父模板中的元素。
      - 子模型可以在父模型基础上增加新的元素，但不可以与父模型重名。
      - 子模型可以再被继承，支持多层的继承关系。
      - 父模型中元素的改动会关联到子模版中。
  - **模型模板**：选择拷贝的模板或者继承的父模板。
  - **模型描述**：对模型的详细描述。
3. 点击**确定**完成操作。

## 步骤二：为模型定义要素

1. 点击需要定义功能的模型的所对应的**查看**。
2. 选择 **功能定义** 标签，并点击 **新增**，根据产品属性设置一个或多个要素。

### 新增属性

1. 在**添加功能**页面，**功能类型**中选择属性，并配置如下信息：
   - **名称**：属性的名称，同一模块下的名称不可重复。
   - **名称（英文）**：如果**名称**为中文，则可在此设置英文名称。如果**名称**为英文，则本设置可忽略。
   - **标识符**：功能的唯一标识码，同一组织下不可重复。此值为JSON格式中的identifier的值，作为设备上报该属性数据的Key，云端根据该标识符校验是否接收数据。
   - **数据类型**：该属性的数据类型。

     + int,float,double：需定义默认值，该数据的单位等信息。
     + enum：需定义枚举项的参数值和该参数的描述。
     + bool：需采用0和1来定义布尔值。
     + string：需定义默认值，String的类型和string的数据长度。
     + timestamp：timestamp的格式为String类型的UTC时间戳(毫秒)。
     + date: date的格式为yyyy-MM-dd HH:mm:ss。
     + struct：通过定义**参数名**，**标识符**，**数据类型**和**单位**来定义一个JSON结构体。
     + array:需定义**元素类型**。确保同一个数组元素类型相同。

   - **是否必填**：如果设置为必填，新建在该产品下的设备时，必须填写该参数。
   - **描述**：对属性的描述。

2. 点击 **确认** 完成创建该属性。

3. 重复以上操作创建更多属性。

### 新增测点

测点页面中的配置信息如下：
1. 在**添加功能**页面，**功能类型**中选择测点，并配置如下信息：
   - **名称**： 测点的名称，同一模块下的名称不可重复。
   - **名称（英文）**：如果名称为中文，则可在此设置英文名称。如果**名称**为英文，则本设置可忽略。
   - **标识符**：功能唯一标识码，同一组织下不可重复。此值为JSON格式中的identifier的值，作为设备上报该属性数据的Key，云端根据该标识符校验是否接收数据。
   - **是否是质量指数**：设置该测点值是否代表数据质量。如果设置为**是**，则配置如下：

      + 质量位：系统使用预定义的数组型的数据质量指示，不可更改。可点击**查看**了解预定义的质量位参数和描述。
      + 值：设置该测点的数据类型。类型只支持int,float和double。

   - **数据类型**：如果该测试不是质量指数，则配置该测点的数据类型。
   -
     + int,float,double：需定义默认值，该数据的单位等信息。
     + enum：需定义枚举项的参数值和该参数的描述。
     + bool：需采用0和1来定义布尔值。
     + string：需定义默认值，String的类型和string的数据长度。
     + timestamp：timestamp的格式为String类型的UTC时间戳(毫秒)。
     + date: date的格式为yyyy-MM-dd HH:mm:ss。
     + struct：通过定义**参数名**，**标识符**，**数据类型**和**单位**来定义一个JSON结构体。

   - **自定义标签**：测点的标签是对测点本身进行描述，可根据需要对测点进行灵活的标识，如测点的类型、分组、优先级等。
   - **描述**：对该测点的描述。

2. 点击 **确认** 来创建该测点。

3. 重复以上操作创建更多测点。

### 新增服务

1. 在**添加功能** 页面，**功能类型**中选择服务，并配置如下信息：
   - **名称**：测点的名称，同一模块下的名称不可重复。
   - **名称（英文）**：如果名称为中文，则可在此设置英文名称。
   - **标识符**：功能唯一标识码，同一组织下不可重复。此值为JSON格式中的identifier的值，作为设备上报该属性数据的Key，云端根据该标识符校验是否接收数据。
   - **调用方式**：服务的调用方式。
     + 同步：云端执行调用服务后，会等待设备回复，如无回应，则调用超时。
     + 异步：云端执行调用后直接返回，由异步的方式获取设备的回复消息。
   - **输入参数**：点击 **新增参数** 配置该服务的输入参数的参数名，识别符，数据类型和数据单位。
   - **输出参数**：点击 **新增参数** 配置该服务的输出参数的参数名，识别符，数据类型和数据单位。
   - **描述**：对该服务的描述。

2. 点击 **确认** 来创建该服务。

3. 重复以上操作创建更多服务。

### 新增事件

1. 在**添加功能** 页面，**功能类型**中选择事件，并配置如下信息：
   - **名称**：测点的名称，同一模块下的名称不可重复。
   - **名称（英文）**：如果名称为中文，则可在此设置英文名称。
   - **标识符**：功能唯一标识码，同一组织下不可重复。此值为JSON格式中的identifier的值，作为设备上报该属性数据的Key，云端根据该标识符校验是否接收数据。
   - **事件类型**：
     + 信息：指设备上报的一般性通知，如完成某项任务等.
     + 告警：告警类信息。设备运行过程中主动上报的突发或异常情况，优先级高。你可以针对不同的事件类型进行业务逻辑处理和统计分析。
     + 故障：故障类信息。设备运行过程中主动上报的突发或异常情况的，优先级高。你可以针对不同的事件类型进行业务逻辑处理和统计分析。
   - **输出参数**：点击 **新增参数**  配置该服务的输出参数的参数名，识别符，数据类型和数据单位。
   - **描述**：对该事件的描述。

2. 点击 **确认** 来创建该事件。

## 步骤3：（可选）添加标签
标签描述同类模型所具有的共性信息。用于区分模型对象所属的领域、类型、范围等各种分类。比如，你可以通过添加**domain:solar**标签代表该模型属于太阳能领域。

1. 在EnOS控制台中选择 **接入管理>模型管理**。
2. 点击需要添加标签的模型后的 **查看**，在标签信息处点击 **编辑** 来添加标签。标签由键值对（key:value）组成。

## 结果

完成功能定义后，系统将自动生成该产品的模型，以JSON格式表述。

## 相关信息

- [模型概述](../model_overview)
- [创建产品](creating_product)
